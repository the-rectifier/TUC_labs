# Exercise 1: Simple Cipher Library Implementation in C

Technical University of Crete

ACE414 - Security of Systems and Services

---

## One-Time Pad:

**Info:**
- The One Time Pass uses a random key the same length as the supplied text.
Encryption is done by some form of function between the Key and Message

**Input:**
- The program asks for the user to input a line of text
- The input is then stripped from the unwanted characters (any character not in 0-9A-Za-z)

**Key Generation:**
- For this simple algorithm a key is generated by reading from /dev/urandom
- The function responsible for the key generation returns a pointer to a NULL terminated byte array
- The key has the same length as the users input.

**Encryption / Decryption:**
- The key is then XORed with the user's input creating the ciphertext
- For decrypting, the key is XORed with the ciphertext resulting back in the original text

**Output:**
- Since the resulting bytes may not be printable the result is printed in HEX format

---

## Caesar Cipher:

**Info:**
- A really simple cipher, shifts the characters right, based on a given key

**Input:**
- The program asks the user for input and then for an integer specifying the shift amount

**Encryption:**
- It then shifts each character to the right based on the key provided and based on the alphabet
0-9A-Za-z. 
- The total length of the alphabet is 62. Meaning a shift key of 62 is the same as 0 etc.

**Algorithm details:**
- Because of the possibility that a shift amount can transcend all 3 sets, and because the sets are continuous
and not explicitly shifted ("9" >> 1 => A and not 0), the algorithm checks the current character and for the event that we surpass the 
set bound by adding the key, it calculates a difference and subtracts it from the key (aka how many shifts until the bound)
and adds it to the selected character. 
- It then adds a flat amount in order to reach the next set and repeats the checks.
- If adding the key will not surpass the set then we just shift key times.
- The algorithm is repeated until the key becomes 0, meaning we consumed the entire key.
- Key values always range from 0 up to and including 61 (the program normalizes it each time (key % 62))

**Decryption:**
- For decrypting is the same exact process but for the key we use the complement of the key
- Encrypting with key = 4 and then with key = 58 ends up at the starting point (shifting by 62 or 0)

---

## **Vigenere:**

**Info:**
- The vigenere cipher uses many differently shifted Caesar's alphabets to cipher each letter based on a specific letter from a 
given key.

**Input:**
- The user enters the text to be ciphered and then the key (both A-Z only)

**Key Generation:**
- Then the program creates the keystream which is the key repeated so that it matches the length 
of the text. 
- If the key is the same length nothing happens, if the key is larger than the text,
then it is shortened to the text length.

**Encryption/Decryption:**
- The encryption function in algebraic form is Ei = (Pi + Ki) % 26
- The decryption function in algebraic form is Di = (Ei - Ki + 26) % 26
- In both cases adding 'A' converts it into an ASCII character.
---
